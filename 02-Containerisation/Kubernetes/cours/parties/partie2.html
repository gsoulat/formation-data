<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Partie 2 - Architecture de Kubernetes</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />

    <link rel="stylesheet" href="../assets/styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>📖 Partie 2</h1>
            <p class="subtitle">Architecture de Kubernetes</p>
            <span class="duration">⏱️ Durée : 10 minutes</span>
        </header>

        <nav class="nav-menu">
            <ul>
                <li><a href="../index.html">🏠 Accueil</a></li>
                <li><a href="partie1.html">Partie 1</a></li>
                <li><a href="partie2.html">Partie 2</a></li>
                <li><a href="partie3.html">Partie 3</a></li>
                <li><a href="partie4.html">Partie 4</a></li>
                <li><a href="partie5.html">Partie 5</a></li>
                <li><a href="partie6.html">Partie 6</a></li>
                <li><a href="partie7.html">Partie 7</a></li>
                <li><a href="partie8.html">Partie 8</a></li>
                <li><a href="partie9.html">Partie 9</a></li>
            </ul>
        </nav>

        <div class="content">
            <section class="section">
                <h2>2. Architecture de Kubernetes</h2>

                <h3>Architecture globale</h3>

                <div class="workflow-diagram">
                    <pre>
┌────────────────────────────────────────────────────────────────┐
│                       KUBERNETES CLUSTER                        │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐  │
│  │              CONTROL PLANE (Master Node)                 │  │
│  │                                                           │  │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │  │
│  │  │  API Server  │  │  Scheduler   │  │  Controller  │  │  │
│  │  │              │  │              │  │   Manager    │  │  │
│  │  └──────────────┘  └──────────────┘  └──────────────┘  │  │
│  │                                                           │  │
│  │  ┌──────────────────────────────────────────────────┐   │  │
│  │  │              etcd (State Store)                    │   │  │
│  │  └──────────────────────────────────────────────────┘   │  │
│  └─────────────────────────────────────────────────────────┘  │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐  │
│  │                    WORKER NODES                          │  │
│  │                                                           │  │
│  │  ┌─────────────┐   ┌─────────────┐   ┌─────────────┐   │  │
│  │  │   Node 1    │   │   Node 2    │   │   Node 3    │   │  │
│  │  │             │   │             │   │             │   │  │
│  │  │  ┌───────┐  │   │  ┌───────┐  │   │  ┌───────┐  │   │  │
│  │  │  │ Pod 1 │  │   │  │ Pod 3 │  │   │  │ Pod 5 │  │   │  │
│  │  │  └───────┘  │   │  └───────┘  │   │  └───────┘  │   │  │
│  │  │  ┌───────┐  │   │  ┌───────┐  │   │  ┌───────┐  │   │  │
│  │  │  │ Pod 2 │  │   │  │ Pod 4 │  │   │  │ Pod 6 │  │   │  │
│  │  │  └───────┘  │   │  └───────┘  │   │  └───────┘  │   │  │
│  │  │             │   │             │   │             │   │  │
│  │  │  kubelet    │   │  kubelet    │   │  kubelet    │   │  │
│  │  │  kube-proxy │   │  kube-proxy │   │  kube-proxy │   │  │
│  │  └─────────────┘   └─────────────┘   └─────────────┘   │  │
│  └─────────────────────────────────────────────────────────┘  │
└────────────────────────────────────────────────────────────────┘
</pre>
                </div>

                <h3>Control Plane (Master Node)</h3>

                <p>Le <strong>Control Plane</strong> gère le cluster et prend toutes les décisions :</p>

                <table>
                    <thead>
                        <tr>
                            <th>Composant</th>
                            <th>Rôle</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>API Server</strong></td>
                            <td>Point d'entrée pour toutes les commandes (kubectl, dashboards). Interface REST</td>
                        </tr>
                        <tr>
                            <td><strong>etcd</strong></td>
                            <td>Base de données clé-valeur qui stocke l'état du cluster</td>
                        </tr>
                        <tr>
                            <td><strong>Scheduler</strong></td>
                            <td>Décide sur quel Node placer les nouveaux Pods</td>
                        </tr>
                        <tr>
                            <td><strong>Controller Manager</strong></td>
                            <td>Exécute les controllers (Node, Replication, Endpoints, etc.)</td>
                        </tr>
                        <tr>
                            <td><strong>Cloud Controller Manager</strong></td>
                            <td>Interactions avec les APIs cloud (AWS, Azure, GCP)</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Worker Nodes</h3>

                <p>Les <strong>Worker Nodes</strong> exécutent les applications :</p>

                <table>
                    <thead>
                        <tr>
                            <th>Composant</th>
                            <th>Rôle</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>kubelet</strong></td>
                            <td>Agent qui s'assure que les conteneurs tournent dans les Pods</td>
                        </tr>
                        <tr>
                            <td><strong>kube-proxy</strong></td>
                            <td>Gère le networking et le load balancing des Services</td>
                        </tr>
                        <tr>
                            <td><strong>Container Runtime</strong></td>
                            <td>Moteur de conteneurs (Docker, containerd, CRI-O)</td>
                        </tr>
                    </tbody>
                </table>

                <div class="alert alert-info">
                    <h4>Managed Kubernetes</h4>
                    <p>
                        Avec les services managés (AKS, EKS, GKE), le Control Plane est géré par le provider.
                        Vous ne gérez que les Worker Nodes (et parfois même pas avec les node pools auto-managés).
                    </p>
                </div>
            </section>

            <div class="key-points">
                <h3>Points clés à retenir</h3>
                <ul>
                    <li>Le Control Plane gère le cluster (API Server, Scheduler, etcd, Controller Manager)</li>
                    <li>Les Worker Nodes exécutent les applications (kubelet, kube-proxy, Container Runtime)</li>
                    <li>etcd stocke l'état complet du cluster</li>
                    <li>Le Scheduler décide où placer les Pods</li>
                    <li>Les services managés (AKS/EKS/GKE) gèrent le Control Plane pour vous</li>
                </ul>
            </div>

            <nav class="section-nav" style="display: flex; justify-content: space-between; margin-top: 40px;">
                <a href="partie1.html" style="display: inline-block; padding: 12px 25px; background: #6c757d; color: white; text-decoration: none; border-radius: 8px; font-weight: 600;">
                    ← Partie 1
                </a>
                <a href="partie3.html" style="display: inline-block; padding: 12px 25px; background: #0066cc; color: white; text-decoration: none; border-radius: 8px; font-weight: 600;">
                    Partie 3 →
                </a>
            </nav>
        </div>

        <footer>
            <p>Formation Kubernetes pour Data Engineering - 2024</p>
            <p><a href="../index.html">← Retour à l'accueil</a></p>
        </footer>
    </div>

    <!-- Prism.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js"></script>
</body>
</html>
